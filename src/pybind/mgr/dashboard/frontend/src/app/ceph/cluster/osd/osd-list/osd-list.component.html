<cd-table [data]="osds"
          (fetchData)="getOsdList()"
          [columns]="columns"
          selectionType="single"
          (updateSelection)="updateSelection($event)"
          [updateSelectionOnRefresh]="false">
  <div class="table-actions btn-toolbar"
       *ngIf="permission.update">
    <div class="btn-group"
         dropdown>
      <button dropdownToggle
              type="button"
              class="btn btn-sm btn-primary dropdown-toggle tc_scrub_toggle"
              [ngClass]="{disabled: !tableComponent.selection.hasSelection}">
        <ng-container i18n> Perform Task</ng-container>
        <span class="caret"></span>
      </button>
      <ul *dropdownMenu
          class="dropdown-menu"
          role="menu">
        <li role="menuitem"
            (click)="scrubAction(false)">
          <a>
            <i class="fa fa-fw fa-stethoscope"></i>
            <ng-container i18n>Scrub</ng-container>
          </a>
        </li>
        <li role="menuitem"
            (click)="scrubAction(true)">
          <a>
            <i class="fa fa-fw fa-stethoscope"></i>
            <ng-container i18n>Deep Scrub</ng-container>
          </a>
        </li>
      </ul>
    </div>

    <button class="btn btn-sm btn-default btn-label tc_configureCluster"
            type="button"
            (click)="configureClusterAction()">
      <i class="fa fa-fw fa-cog"
         aria-hidden="true"></i>
      <ng-container i18n>Set Cluster-wide OSD Flags</ng-container>
    </button>
  </div>

  <cd-osd-details cdTableDetail
                  [selection]="selection">
  </cd-osd-details>
</cd-table>

<ng-template #statusColor
             let-value="value">
  <span *ngFor="let state of value; last as last">
    <span [class.text-success]="'up' === state || 'in' === state"
          [class.text-warning]="'down' === state || 'out' === state">
      {{ state }}</span>
    <span *ngIf="!last">, </span>
    <!-- Has to be on the same line to prevent a space between state and comma. -->
  </span>
</ng-template>
<!--
<ng-template #lifeExpectancyStateGreenTooltipTpl>
  <div [innerHtml]="'Predicted device life expectancy weeks over 6 weeks'"></div>
</ng-template>

<ng-template #lifeExpectancyStateYellowTooltipTpl>
  <div [innerHtml]="'Predicted device life expectancy weeks during 4 - 6 weeks'"></div>
</ng-template>

<ng-template #lifeExpectancyStateRedTooltipTpl>
  <div [innerHtml]="'Predicted device life expectancy weeks less 4 weeks'"></div>
</ng-template>

<ng-template #lifeExpectancyStateGrayTooltipTpl>
  <div [innerHtml]="'Predicted device life expectancy none configured'"></div>
</ng-template>
-->
<ng-template #statusLight
             let-value="value">
             <ng-template #lifeExpectancyStateTooltipTpl>
              <div *ngIf="value==='green'" [innerHtml]="'Predicted device life expectancy weeks over 6 weeks'"></div>
              <div *ngIf="value==='yellow'" [innerHtml]="'Predicted device life expectancy weeks during 4 - 6 weeks'"></div>
              <div *ngIf="value==='red'" [innerHtml]="'Predicted device life expectancy weeks less 4 weeks'"></div>
              <div *ngIf="value==='unknown'" [innerHtml]="'Predicted device life expectancy none configured'"></div>
             </ng-template>
  <span class="text-muted" [tooltip]="lifeExpectancyStateTooltipTpl" placement="left">
    <svg width="20" height="20">
      <circle *ngIf="value==='green'" cx="10" cy="10" r="8" stroke="green" stroke-width="1" fill="green" />
      <circle *ngIf="value==='yellow'" cx="10" cy="10" r="8" stroke="yellow" stroke-width="1" fill="yellow" />
      <circle *ngIf="value==='red'" cx="10" cy="10" r="8" stroke="red" stroke-width="1" fill="red" />
      <circle *ngIf="value==='unknown'" cx="10" cy="10" r="8" stroke="gray" stroke-width="1" fill="gray" />
    </svg>
  </span>
</ng-template>

<ng-template #osdUsageTpl
             let-row="row">
  <cd-usage-bar [totalBytes]="row.stats.stat_bytes"
                [usedBytes]="row.stats.stat_bytes_used"></cd-usage-bar>
</ng-template>
